import{a as Z}from"./chunk-DVOM4FA5.js";import{a as X}from"./chunk-K6AQFHQZ.js";import{a as J}from"./chunk-XGG2NXRS.js";import{b as F,e as U,f as A}from"./chunk-UNETXBBP.js";import{c as Q,g as Y}from"./chunk-BS6GGXZ2.js";import{a as K}from"./chunk-AT2Y7737.js";import{$ as y,A as l,B as M,C as r,D as c,E as s,F as S,I as _,K as d,L as m,R,S as x,V as j,X as H,Y as v,da as N,g as P,i as u,ia as W,j as C,ja as w,ka as E,p as g,q as h,ra as q,ua as $,va as z,wa as G,x as p,xa as T,y as O,ya as b,za as V}from"./chunk-R7YALVTQ.js";import{k as L}from"./chunk-6ZVQRB5I.js";import"./chunk-LGOCNUIX.js";var D=function(e){return e.One="1",e.Two="2",e.Three="3",e.Four="4",e.Five="5",e}(D||{});var I=(()=>{let t=class t extends Y{constructor(){super([]),this.exchangeService=u(Z),this.authService=u($)}get userId(){return this.authService.userId}get isEmpty(){return this.exchanges.length===0}get exchanges(){return this.result().filter(n=>!n.hasBeenRated)}setExchanges(){let n=this.exchangeService.getByUserId(this.authService.userId);this.execute(n)}discardExchange(n){this.exchangeService.discard(n).subscribe(()=>{this.setExchanges()})}addRating(n,i){return this.exchangeService.setExchangeMade(n,i)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=P({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var ee=(()=>{let t=class t{constructor(n){this.router=n,this.onselect=onselect,this.TypeButton=b,this.Icon=T,this.scoreRatings=Q(D),this.userId="",this.exchangeId="",this.form=new U({score:new A("",F.required),comment:new A("",F.required)}),this.service=u(I),this.saveRating=new y}onSelectedScoreRating(n){this.form.get("score")?.setValue(n)}onChangeComment(n){this.form.get("comment")?.setValue(n)}onRating(){let n={userIdWhoWasRated:this.userId,userIdWhoRated:this.service.userId,score:this.form.get("score")?.value,comment:this.form.get("comment")?.value};this.form.valid&&this.service.addRating(this.exchangeId,n).subscribe(()=>{this.saveRating.emit()})}};t.\u0275fac=function(i){return new(i||t)(O(q))},t.\u0275cmp=C({type:t,selectors:[["app-add-rating"]],inputs:{userId:"userId",exchangeId:"exchangeId"},outputs:{saveRating:"saveRating"},standalone:!0,features:[H([I]),v],decls:9,vars:9,consts:[[1,"c-add-rating-card"],[1,"c-add-rating-card__title-rating"],[1,"o-text-base-semibold"],[1,"c-add-rating-card__score-rating"],["src","assets/icons/star.svg",3,"applyClass"],[3,"options","selectedOption"],[3,"isTextArea","placeholder","textChanged"],[3,"description","icon","typeButton","click"]],template:function(i,o){i&1&&(c(0,"div",0)(1,"div",1)(2,"span",2),x(3,"Calificai\xF3n: "),s(),c(4,"div",3),S(5,"svg-icon",4),c(6,"app-select",5),d("selectedOption",function(B){return o.onSelectedScoreRating(B)}),s()()(),c(7,"app-input",6),d("textChanged",function(B){return o.onChangeComment(B)}),s(),c(8,"app-button",7),d("click",function(){return o.onRating()}),s()()),i&2&&(p(5),R("c-add-rating-card__icon o-icon-size-lg"),r("applyClass",!0),p(1),r("options",o.scoreRatings),p(1),r("isTextArea",!0)("placeholder","Escribe un comentario"),p(1),r("description","Calificar")("icon",o.Icon.Star)("typeButton",o.TypeButton.Primary))},dependencies:[E,V,X,J,G,z],encapsulation:2});let e=t;return e})();function ie(e,t){if(e&1){let a=_();c(0,"app-button",7),d("click",function(){g(a);let i=m(2);return h(i.onDiscardExchange())}),s()}if(e&2){let a=m(2);r("description","Descartar intercambio")("icon",a.Icon.Delete)("typeButton",a.TypeButton.Secondary)}}function ae(e,t){if(e&1){let a=_();c(0,"app-button",7),d("click",function(){g(a);let i=m();return h(i.onShowRating())}),s(),l(1,ie,1,3,"app-button",8)}if(e&2){let a=m();r("description","Calificar intercambio")("icon",a.Icon.Star)("typeButton",a.TypeButton.Primary),p(1),r("ngIf",a.exchangeCard.isDiscarded)}}function re(e,t){if(e&1){let a=_();c(0,"app-button",7),d("click",function(){g(a);let i=m();return h(i.onShowRating())}),s()}if(e&2){let a=m();r("description","Cerrar")("icon",a.Icon.Delete)("typeButton",a.TypeButton.Secondary)}}function oe(e,t){if(e&1){let a=_();c(0,"app-add-rating",9),d("saveRating",function(){g(a);let i=m();return h(i.onSaveRating())}),s()}if(e&2){let a=m();r("exchangeId",a.exchangeCard.id)("userId",a.exchangeCard.userId)}}var te=(()=>{let t=class t{constructor(){this.TypeButton=b,this.Icon=T,this.exchangeCard={},this.discardExchange=new y,this.showAddRating=!1,this.headerDetail={},this.saveRating=new y}onSaveRating(){this.saveRating.emit()}onDiscardExchange(){this.discardExchange.emit(this.exchangeCard.id)}onShowRating(){this.showAddRating=!this.showAddRating}ngOnInit(){this.headerDetail={photo:this.exchangeCard.userPhoto,title:this.exchangeCard.userName,description:this.exchangeCard.date}}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=C({type:t,selectors:[["app-exchange-card"]],inputs:{exchangeCard:"exchangeCard"},outputs:{discardExchange:"discardExchange",saveRating:"saveRating"},standalone:!0,features:[v],decls:9,vars:7,consts:[[1,"c-exchange-card"],[3,"headerDetail","withDescription"],[1,"o-text-base-normal"],[1,"c-exchange-card__buttons"],[3,"ngIfElse","ngIf"],["showAddRatingTemplate",""],[3,"ngIf"],[3,"description","icon","typeButton","click"],[3,"description","icon","typeButton","click",4,"ngIf"],[3,"exchangeId","userId","saveRating"]],template:function(i,o){if(i&1&&(c(0,"div",0),S(1,"app-header-detail",1),c(2,"span",2),x(3),s(),c(4,"div",3),l(5,ae,2,4,"ng-template",4),l(6,re,1,3,"ng-template",null,5,N),s(),l(8,oe,1,2,"ng-template",6),s()),i&2){let f=M(7);p(1),r("headerDetail",o.headerDetail)("withDescription",!0),p(2),j(" Has elegido intercambiar ",o.exchangeCard.articleToExchange," con ",o.exchangeCard.articleToReceive,". "),p(2),r("ngIfElse",f)("ngIf",!o.showAddRating),p(3),r("ngIf",o.showAddRating)}},dependencies:[E,w,V,ee,K],encapsulation:2});let e=t;return e})();function ce(e,t){e&1&&(c(0,"span",2),x(1," Cargando..."),s())}function se(e,t){e&1&&(c(0,"span",2),x(1," No hay intercambios para mostrar"),s())}function pe(e,t){if(e&1){let a=_();c(0,"app-exchange-card",4),d("discardExchange",function(){let o=g(a).$implicit,f=m(2);return h(f.onDiscardExchange(o.id))})("saveRating",function(){g(a);let i=m(2);return h(i.onSaveRating())}),s()}if(e&2){let a=t.$implicit;r("exchangeCard",a)}}function me(e,t){if(e&1&&l(0,pe,1,1,"app-exchange-card",3),e&2){let a=m();r("ngForOf",a.service.exchanges)}}var ct=(()=>{let t=class t{constructor(){this.getLayout=L,this.service=u(I),this.service.setExchanges()}onDiscardExchange(n){this.service.discardExchange(n)}onSaveRating(){this.service.setExchanges()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=C({type:t,selectors:[["ng-component"]],standalone:!0,features:[v],decls:5,vars:6,consts:[[1,"o-layout-view-rating-cards"],[3,"ngIf"],[1,"o-text-lg-semibold"],[3,"exchangeCard","discardExchange","saveRating",4,"ngFor","ngForOf"],[3,"exchangeCard","discardExchange","saveRating"]],template:function(i,o){i&1&&(c(0,"div")(1,"div",0),l(2,ce,2,0,"ng-template",1),l(3,se,2,0,"ng-template",1),l(4,me,1,1,"ng-template",1),s()()),i&2&&(R(o.getLayout()),p(2),r("ngIf",o.service.isWorking()),p(1),r("ngIf",o.service.isEmpty),p(1),r("ngIf",o.service.isCompleted()))},dependencies:[E,W,w,te],encapsulation:2});let e=t;return e})();export{ct as ExchangesPageComponent};
