import{a as N,b as $}from"./chunk-KAFTCFFA.js";import{a as G}from"./chunk-XGG2NXRS.js";import{b as u,e as z,f}from"./chunk-UNETXBBP.js";import"./chunk-AT2Y7737.js";import{A as _,B as y,C as p,D as a,E as s,F as x,I as V,K as c,L as v,O as A,S as T,W as w,Y as W,da as F,g as C,i as n,j as S,ja as U,ka as j,p as E,q as I,ra as k,s as P,ta as L,ua as R,x as m,xa as B,za as H}from"./chunk-R7YALVTQ.js";import{a as M,k as q}from"./chunk-6ZVQRB5I.js";import{a as h,b}from"./chunk-LGOCNUIX.js";var D=(()=>{let t=class t{constructor(){this.userService=n(L),this.authService=n(R),this.router=n(k),this._user=this.authService.user,this.form=new z({photo:new f(this._user.photo,[u.required]),about:new f(this._user.about,[u.required]),numberWhatsapp:new f(this._user.numberWhatsapp,[u.required,u.pattern(/^09[0-9]{8}$/)])})}get isFormValid(){return this.form.valid}get user(){return this._user}setPhoto(e){this._user=b(h({},this._user),{photo:e}),this.setValue("photo",e)}setValue(e,r){this.form.get(e)?.setValue(r)}editProfile(){let e=h(h({},this._user),this.form.value);this.userService.update(e.id,e).subscribe(),this._user=e,this.authService.setUser(e),this.router.navigate([`${M.Home}`]).then()}setUser(){this._user=this.authService.user}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function J(i,t){i&1&&(a(0,"span",7),T(1,"Por favor, antes de editar el perfil, completa los campos obligatorios..."),s())}function K(i,t){if(i&1){let g=V();a(0,"app-button",8),c("click",function(){E(g);let r=v();return I(r.onEditProfile())}),s()}if(i&2){let g=v();p("description","Guardar cambios")("icon",g.Icon.Save)}}var be=(()=>{let t=class t{constructor(){this.Icon=B,this.getLayout=q,this.service=n(D),this.imageService=n($),this.service.setUser()}onAboutMeChanged(e){this.service.setValue("about",e)}onWhatsappChanged(e){this.service.setValue("numberWhatsapp",e)}onEditProfile(){this.service.editProfile()}onImageSelected(e){this.imageService.uploadImage(e).subscribe(r=>{this.service.setPhoto(r.data.url)})}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=S({type:t,selectors:[["ng-component"]],standalone:!0,features:[W],decls:9,vars:15,consts:[[1,"c-edit-profile-page__upload-photo"],[1,"c-edit-profile-page__photo",3,"alt","src"],[3,"imageSelected"],[3,"isTextArea","placeholder","title","value","textChanged"],[3,"icon","placeholder","title","value","textChanged"],[3,"ngIfElse","ngIf"],["buttonEditProfileTemplate",""],[1,"o-text-sm-bold"],[3,"description","icon","click"]],template:function(r,o){if(r&1&&(a(0,"div")(1,"div",0),x(2,"img",1),a(3,"app-button-select-image",2),c("imageSelected",function(l){return o.onImageSelected(l)}),s()(),a(4,"app-input",3),c("textChanged",function(l){return o.onAboutMeChanged(l)}),s(),a(5,"app-input",4),c("textChanged",function(l){return o.onWhatsappChanged(l)}),s(),_(6,J,2,0,"ng-template",5),_(7,K,1,2,"ng-template",null,6,F),s()),r&2){let d=y(8);w("c-edit-profile-page ",o.getLayout(),""),m(2),A("src",o.service.user.photo,P),p("alt",o.service.user.name),m(2),p("isTextArea",!0)("placeholder","Escribe algo sobre ti")("title","Acerca de m\xED")("value",o.service.user.about),m(1),p("icon",o.Icon.Whatsapp)("placeholder","Escribe tu n\xFAmero de WhatsApp")("title","WhatsApp")("value",o.service.user.numberWhatsapp),m(1),p("ngIfElse",d)("ngIf",!o.service.isFormValid)}},dependencies:[j,U,G,H,N],encapsulation:2});let i=t;return i})();export{be as EditProfilePageComponent};
